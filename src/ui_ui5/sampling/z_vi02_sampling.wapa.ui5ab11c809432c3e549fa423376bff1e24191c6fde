sap.ui.define([                                                                                                                                                                                                                                                
	"sap/ui/core/mvc/Controller",                                                                                                                                                                                                                                 
	"sap/ui/Device",                                                                                                                                                                                                                                              
	"sap/ui/core/Core",                                                                                                                                                                                                                                           
	"sap/ui/core/Fragment",                                                                                                                                                                                                                                       
	"sap/base/Log",                                                                                                                                                                                                                                               
	"sap/ui/model/json/JSONModel",                                                                                                                                                                                                                                
	"./BaseController",                                                                                                                                                                                                                                           
	"sap/ui/core/library",                                                                                                                                                                                                                                        
	"sap/ui/core/message/Message",                                                                                                                                                                                                                                
	"sap/m/MessageToast",                                                                                                                                                                                                                                         
	"sap/m/MessageBox",                                                                                                                                                                                                                                           
	"sap/m/Button",                                                                                                                                                                                                                                               
	"sap/m/Dialog",                                                                                                                                                                                                                                               
	"sap/m/ButtonType",                                                                                                                                                                                                                                           
	"sap/m/DialogType",                                                                                                                                                                                                                                           
	"sap/m/Label",                                                                                                                                                                                                                                                
	"sap/m/ComboBox",                                                                                                                                                                                                                                             
	"sap/m/Text",                                                                                                                                                                                                                                                 
	"sap/m/Input",                                                                                                                                                                                                                                                
	"sap/ui/core/BusyIndicator",                                                                                                                                                                                                                                  
	"../model/formatter",                                                                                                                                                                                                                                         
	"../libs/constants",                                                                                                                                                                                                                                          
], function (Controller, Device, Core, Fragment, Log, JSONModel, BaseController, Library, Message, MessageToast, MessageBox, Button, Dialog, ButtonType, DialogType, Label, ComboBox, Text, Input, BusyIndicator, formatter, constants) {                      
	"use strict";                                                                                                                                                                                                                                                 
	var MessageType = Library.MessageType;                                                                                                                                                                                                                        
	var path;                                                                                                                                                                                                                                                     
	var Logger = Log;                                                                                                                                                                                                                                             
	var ValueState = Library.ValueState;                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
	return BaseController.extend("z_vi02_sampling.controller.Main", {                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
		currentSelectedTableItemFromFirstSection: undefined,                                                                                                                                                                                                         
		formatter: formatter,                                                                                                                                                                                                                                        
		testing: false,                                                                                                                                                                                                                                              
		selectedLgnum: "",                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onInit: function () {                                                                                                                                                                                                                                        
			// apply compact density if touch is not supported, the standard cozy design otherwise                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			this.getView().addStyleClass(Device.support.touch ? "sapUiSizeCozy" : "sapUiSizeCompact");                                                                                                                                                                  
			//Set the jsonModel for all Elements of the screen                                                                                                                                                                                                          
			this.startProcess();                                                                                                                                                                                                                                        
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		startProcess: function () {                                                                                                                                                                                                                                  
			if (this.testing) {                                                                                                                                                                                                                                         
				if (!this.testDialog) {                                                                                                                                                                                                                                    
					const that = this;                                                                                                                                                                                                                                        
					this.testDialog = Fragment.load({                                                                                                                                                                                                                         
						id: that.getView().getId(),                                                                                                                                                                                                                              
						name: "z_vi02_sampling.view.RequestsTest",                                                                                                                                                                                                               
						controller: that                                                                                                                                                                                                                                         
					}).then(function (oDialog) {                                                                                                                                                                                                                              
						return oDialog;                                                                                                                                                                                                                                          
					});                                                                                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
				this.testDialog.then(function (oDialog) {                                                                                                                                                                                                                  
					oDialog.open();                                                                                                                                                                                                                                           
				});                                                                                                                                                                                                                                                        
			} else {                                                                                                                                                                                                                                                    
				this.setScreenState(1);                                                                                                                                                                                                                                    
				// this.onOpenTesLoginDialog()                                                                                                                                                                                                                             
				if (!this.getView()?.getModel("loginData")) {                                                                                                                                                                                                              
					BusyIndicator.show();                                                                                                                                                                                                                                     
					this.requestData("VH_WarehouseNumberSet", [], this).then(data => {                                                                                                                                                                                        
						let lgnumsModel = new JSONModel(data);                                                                                                                                                                                                                   
						this.getView().setModel(lgnumsModel, "lgnumsModel");                                                                                                                                                                                                     
						this.getBaseLgnum();                                                                                                                                                                                                                                     
					}).catch(err => {                                                                                                                                                                                                                                         
						BusyIndicator.hide();                                                                                                                                                                                                                                    
						this.handleError(err);                                                                                                                                                                                                                                   
						console.log(err);                                                                                                                                                                                                                                        
					});                                                                                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		getBaseLgnum: function () {                                                                                                                                                                                                                                  
			BusyIndicator.show();                                                                                                                                                                                                                                       
			const baseUrl = constants.service.url;                                                                                                                                                                                                                      
			var dataModel = new sap.ui.model.odata.ODataModel(baseUrl, true);                                                                                                                                                                                           
			dataModel.callFunction(                                                                                                                                                                                                                                     
				"/GetUserDefaultWarehouse", {                                                                                                                                                                                                                              
				method: "GET",                                                                                                                                                                                                                                             
				urlParameters: {},                                                                                                                                                                                                                                         
				success: function (data) {                                                                                                                                                                                                                                 
					if (data.Lgnum) {                                                                                                                                                                                                                                         
						this.selectedLgnum = data.Lgnum;                                                                                                                                                                                                                         
						this.getWCsFromLgnum(data.Lgnum);                                                                                                                                                                                                                        
					} else {                                                                                                                                                                                                                                                  
						this.openLoginDialog();                                                                                                                                                                                                                                  
						BusyIndicator.hide();                                                                                                                                                                                                                                    
					}                                                                                                                                                                                                                                                         
				}.bind(this),                                                                                                                                                                                                                                              
				error: function (err) {                                                                                                                                                                                                                                    
					BusyIndicator.hide();                                                                                                                                                                                                                                     
					this.handleError(err);                                                                                                                                                                                                                                    
					console.log(err);                                                                                                                                                                                                                                         
				}.bind(this)                                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
			);                                                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		getWCsFromLgnum: function (lgnum) {                                                                                                                                                                                                                          
			BusyIndicator.show();                                                                                                                                                                                                                                       
			const that = this;                                                                                                                                                                                                                                          
			const filter = [{ "field": "Lgnum", "sign": "EQ", "value": lgnum }];                                                                                                                                                                                        
			this.requestData("VH_WorkstationSet", filter, this).then(data => {                                                                                                                                                                                          
				let wcsModel = new JSONModel(data);                                                                                                                                                                                                                        
				this.getView().setModel(wcsModel, "wcsModel");                                                                                                                                                                                                             
				this.openLoginDialog();                                                                                                                                                                                                                                    
				BusyIndicator.hide();                                                                                                                                                                                                                                      
			}).catch(err => {                                                                                                                                                                                                                                           
				that.handleError(err);                                                                                                                                                                                                                                     
				BusyIndicator.hide();                                                                                                                                                                                                                                      
				console.log(err)                                                                                                                                                                                                                                           
			})                                                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		openLoginDialog: function () {                                                                                                                                                                                                                               
			const lgnumsData = this.getView().getModel("lgnumsModel").getData().results;                                                                                                                                                                                
			const wcData = this.getView().getModel("wcsModel")?.getData().results;                                                                                                                                                                                      
			const lgnum = this.selectedLgnum;                                                                                                                                                                                                                           
			const loginView = new JSONModel({                                                                                                                                                                                                                           
				lgnums: lgnumsData,                                                                                                                                                                                                                                        
				wcs: wcData,                                                                                                                                                                                                                                               
				selectedLgnum: lgnum                                                                                                                                                                                                                                       
			});                                                                                                                                                                                                                                                         
			if (!this.oLoginDialog) {                                                                                                                                                                                                                                   
				const that = this;                                                                                                                                                                                                                                         
				this.oLoginDialog = Fragment.load({                                                                                                                                                                                                                        
					id: that.getView().getId(),                                                                                                                                                                                                                               
					name: "z_vi02_sampling.view.LoginPopup",                                                                                                                                                                                                                  
					controller: that                                                                                                                                                                                                                                          
				}).then(function (oDialog) {                                                                                                                                                                                                                               
					that.getView().addDependent(oDialog);                                                                                                                                                                                                                     
					oDialog.setModel(loginView, "loginModel");                                                                                                                                                                                                                
					return oDialog;                                                                                                                                                                                                                                           
				});                                                                                                                                                                                                                                                        
			} else {                                                                                                                                                                                                                                                    
				this.byId("loginDialog").setModel(loginView, "loginModel");                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
			this.oLoginDialog.then(function (oDialog) {                                                                                                                                                                                                                 
				oDialog.open();                                                                                                                                                                                                                                            
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		handleLgnumChange: function (oEvent) {                                                                                                                                                                                                                       
			const workcenterComboBox = oEvent.getSource(),                                                                                                                                                                                                              
				lgnumKey = workcenterComboBox.getSelectedKey(),                                                                                                                                                                                                            
				lgnum = workcenterComboBox.getValue();                                                                                                                                                                                                                     
			if (!lgnumKey && lgnum) {                                                                                                                                                                                                                                   
				workcenterComboBox.setValueState(ValueState.Error);                                                                                                                                                                                                        
				workcenterComboBox.setValueStateText(this.getTranslatedText("ComboBox.Lgnum.Error"));                                                                                                                                                                      
			} else {                                                                                                                                                                                                                                                    
				workcenterComboBox.setValueState(ValueState.None);                                                                                                                                                                                                         
				const wc = this.byId("workcenterComboBox").getValue();                                                                                                                                                                                                     
				this.byId("workcenterComboBox").setEnabled(lgnumKey.length > 0)                                                                                                                                                                                            
				this.byId("btnLogin").setEnabled(wc.length > 0 && lgnumKey.length > 0);                                                                                                                                                                                    
				this.selectedLgnum = lgnumKey;                                                                                                                                                                                                                             
				this.getWCsFromLgnum(lgnumKey);                                                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		handleWCChange: function (oEvent) {                                                                                                                                                                                                                          
			const lgnumComboBox = oEvent.getSource(),                                                                                                                                                                                                                   
				wcKey = lgnumComboBox.getSelectedKey(),                                                                                                                                                                                                                    
				wc = lgnumComboBox.getValue();                                                                                                                                                                                                                             
			if (!wcKey && wc) {                                                                                                                                                                                                                                         
				lgnumComboBox.setValueState(ValueState.Error);                                                                                                                                                                                                             
				lgnumComboBox.setValueStateText(this.getTranslatedText("ComboBox.WC.Error"));                                                                                                                                                                              
			} else {                                                                                                                                                                                                                                                    
				lgnumComboBox.setValueState(ValueState.None);                                                                                                                                                                                                              
				const lgnum = this.byId("lgnumComboBox").getValue();                                                                                                                                                                                                       
				this.byId("btnLogin").setEnabled(wcKey.length > 0 && lgnum.length > 0);                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onLoginPressed: function (oEvent) {                                                                                                                                                                                                                          
			const lgnum = this.byId("lgnumComboBox").getSelectedKey();                                                                                                                                                                                                  
			const workcenter = this.byId("workcenterComboBox").getSelectedKey();                                                                                                                                                                                        
			this.wcLoginRequest(lgnum, workcenter);                                                                                                                                                                                                                     
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onCloseLoginDialog: function () {                                                                                                                                                                                                                            
			if (this.oLoginDialog) {                                                                                                                                                                                                                                    
				this.byId("loginDialog").close();                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		loginAfterClose: function () {                                                                                                                                                                                                                               
			this.byId("scanInput").focus();                                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		wcLoginRequest: function (lgnum, workcenter) {                                                                                                                                                                                                               
			const that = this;                                                                                                                                                                                                                                          
			BusyIndicator.show();                                                                                                                                                                                                                                       
			const baseUrl = constants.service.login;                                                                                                                                                                                                                    
			var dataModel = new sap.ui.model.odata.ODataModel(baseUrl, true);                                                                                                                                                                                           
			dataModel.read(`/LogonCollection(WORKSTATION='${workcenter}',WS_MODE='SMPL')`, {                                                                                                                                                                            
				success: (data) => {                                                                                                                                                                                                                                       
					const loginResponse = new JSONModel(data.results);                                                                                                                                                                                                        
					this.getView().setModel(loginResponse, "loginResponse");                                                                                                                                                                                                  
					let loginData = new JSONModel();                                                                                                                                                                                                                          
					loginData.Workcenter = workcenter;                                                                                                                                                                                                                        
					loginData.Lgnum = lgnum;                                                                                                                                                                                                                                  
					loginData.User = 'sbabalev';                                                                                                                                                                                                                              
					this.getView().setModel(new JSONModel(loginData), "loginData");                                                                                                                                                                                           
					BusyIndicator.hide();                                                                                                                                                                                                                                     
					this.onCloseLoginDialog();                                                                                                                                                                                                                                
				},                                                                                                                                                                                                                                                         
				error: (err) => {                                                                                                                                                                                                                                          
					that.handleError(err);                                                                                                                                                                                                                                    
					console.log(err);                                                                                                                                                                                                                                         
					BusyIndicator.hide();                                                                                                                                                                                                                                     
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onScanHuSubmit: function (event) {                                                                                                                                                                                                                           
			// make read/post request                                                                                                                                                                                                                                   
			BusyIndicator.show();                                                                                                                                                                                                                                       
			const loginData = this.getView().getModel("loginData").getData();                                                                                                                                                                                           
			const lgnum = loginData.Lgnum;                                                                                                                                                                                                                              
			const workcenter = loginData.Workcenter;                                                                                                                                                                                                                    
			const huNum = event.getParameter("value");                                                                                                                                                                                                                  
			let huData = {};                                                                                                                                                                                                                                            
			const baseUrl = constants.service.url;                                                                                                                                                                                                                      
			var dataModel = new sap.ui.model.odata.ODataModel(baseUrl, true);                                                                                                                                                                                           
			dataModel.read(`/HUHeaderSet(Lgnum='${lgnum}',Huident='${huNum}',Workstation='${workcenter}')?$expand=NavToHUItem,NavToHUItemQuantity`, {                                                                                                                   
				success: (data) => {                                                                                                                                                                                                                                       
					if (data) {                                                                                                                                                                                                                                               
						if (data.NavToHUItem.results.length > 1) {                                                                                                                                                                                                               
							const text = this.getTranslatedText("HuRead.MultProd.Text");                                                                                                                                                                                            
							const title = this.getTranslatedText("HuRead.MultProd.Title");                                                                                                                                                                                          
							MessageBox.show(                                                                                                                                                                                                                                        
								text, {                                                                                                                                                                                                                                                
								icon: MessageBox.Icon.ERROR,                                                                                                                                                                                                                           
								title: title,                                                                                                                                                                                                                                          
								actions: [MessageBox.Action.OK]                                                                                                                                                                                                                        
							});                                                                                                                                                                                                                                                     
							this.byId("scanInput").focus();                                                                                                                                                                                                                         
							return;                                                                                                                                                                                                                                                 
						} else {                                                                                                                                                                                                                                                 
							huData = { results: [data] };                                                                                                                                                                                                                           
							huData.results[0].NavToHUItem = data.NavToHUItem.results[0];                                                                                                                                                                                            
							huData.results[0].NavToHUItemQuantity = data.NavToHUItemQuantity.results[0];                                                                                                                                                                            
							this.getView().setModel(new JSONModel(huData), "scannedHU");                                                                                                                                                                                            
							this.byId("huTable").setSelectedIndex(0);                                                                                                                                                                                                               
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
					BusyIndicator.hide();                                                                                                                                                                                                                                     
				},                                                                                                                                                                                                                                                         
				error: (err) => {                                                                                                                                                                                                                                          
					this.handleError(err);                                                                                                                                                                                                                                    
					console.log(err);                                                                                                                                                                                                                                         
					BusyIndicator.hide();                                                                                                                                                                                                                                     
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//  * Select row from section one UI table                                                                                                                                                                                                                   
		onHuSelect: function (event, selectRow) {                                                                                                                                                                                                                    
			const table = this.byId("huTable");                                                                                                                                                                                                                         
			let selectedIndex = -1; //If selectRow is passed use it.                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			if (selectRow !== undefined) {                                                                                                                                                                                                                              
				selectedIndex = selectRow; // If selectFirstRow is passed use 0.                                                                                                                                                                                           
			} else {                                                                                                                                                                                                                                                    
				selectedIndex = table.getSelectedIndex();                                                                                                                                                                                                                  
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (selectedIndex !== -1) {                                                                                                                                                                                                                                 
				this.currentSelectedTableItemFromFirstSection = selectedIndex;                                                                                                                                                                                             
				const dataArr = this.getView().getModel("scannedHU").getData().results;                                                                                                                                                                                    
				const createdHUNav = dataArr[selectedIndex];                                                                                                                                                                                                               
				const jsonModelCreatedHUNav = new JSONModel(createdHUNav);                                                                                                                                                                                                 
				this.getView().setModel(jsonModelCreatedHUNav, "selectedRow");                                                                                                                                                                                             
				this.getView().setModel(jsonModelCreatedHUNav, "lastSelectedRow");                                                                                                                                                                                         
				this.getUoMsForProduct(createdHUNav.NavToHUItem.Matnr);                                                                                                                                                                                                    
				//this.getElementsModel().refresh(true);                                                                                                                                                                                                                   
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		getUoMsForProduct: function (matnr) {                                                                                                                                                                                                                        
			BusyIndicator.show();                                                                                                                                                                                                                                       
			const filter = [{ "field": "Product", "sign": "EQ", "value": matnr }];                                                                                                                                                                                      
			this.requestData("ProductUnitOfMeasureSet", filter, this).then(data => {                                                                                                                                                                                    
				this.getView().setModel(new JSONModel(data.results), "uomsForProduct");                                                                                                                                                                                    
				this.getView().byId("inputUoMToRemove").setModel(new JSONModel(data));                                                                                                                                                                                     
				this.setScreenState(2);                                                                                                                                                                                                                                    
				this.refreshModels();                                                                                                                                                                                                                                      
				BusyIndicator.hide();                                                                                                                                                                                                                                      
			}).catch(err => {                                                                                                                                                                                                                                           
				this.handleError(err);                                                                                                                                                                                                                                     
				console.log(err);                                                                                                                                                                                                                                          
				BusyIndicator.hide();                                                                                                                                                                                                                                      
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onPbRemainingPress: function () {                                                                                                                                                                                                                            
			this.clearData();                                                                                                                                                                                                                                           
			this.setScreenState(1);                                                                                                                                                                                                                                     
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onNoPutbackLeftPress: function () {                                                                                                                                                                                                                          
			this.onNoPtbackLeftRequest();                                                                                                                                                                                                                               
			                                                                                                                                                                                                                                                            
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onNoPtbackLeftRequest: function () {                                                                                                                                                                                                                         
			const huData = this.getView().getModel("selectedRow").getData();                                                                                                                                                                                            
			const entitled = huData.Entitled;                                                                                                                                                                                                                           
			const huident = huData.Huident;                                                                                                                                                                                                                             
			const lgnum = huData.Lgnum;                                                                                                                                                                                                                                 
			const matnr = huData.NavToHUItem.Matnr;                                                                                                                                                                                                                     
			const that = this;                                                                                                                                                                                                                                          
			const dataModel = new sap.ui.model.odata.v2.ODataModel(constants.service.url);                                                                                                                                                                              
			const requestBody = {                                                                                                                                                                                                                                       
				"Entitled": entitled,                                                                                                                                                                                                                                      
				"Lgnum": lgnum,                                                                                                                                                                                                                                            
				"Matnr": matnr,                                                                                                                                                                                                                                            
				"Huident": huident,                                                                                                                                                                                                                                        
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			dataModel.create("/HUWarehouseTaskSet", requestBody, {                                                                                                                                                                                                      
				success: function (data, response) {                                                                                                                                                                                                                       
					that.clearData();                                                                                                                                                                                                                                         
					that.setScreenState(1);                                                                                                                                                                                                                                   
				},                                                                                                                                                                                                                                                         
				error: function (err) {                                                                                                                                                                                                                                    
					console.log(err);                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		clearData: function () {                                                                                                                                                                                                                                     
			this.getView().setModel(new JSONModel(), "selectedRow");                                                                                                                                                                                                    
			this.getView().setModel(new JSONModel(), "lastSelectedRow");                                                                                                                                                                                                
			this.getView().setModel(new JSONModel(), "scannedHU");                                                                                                                                                                                                      
			this.byId("scanInput").setValue(undefined);                                                                                                                                                                                                                 
			this.byId("pmatTxt").setText(undefined);                                                                                                                                                                                                                    
			this.getView().byId("inputUoMToRemove").setSelectedKey("");                                                                                                                                                                                                 
			this.refreshModels();                                                                                                                                                                                                                                       
			this.byId("scanInput").focus();                                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		setScreenState: function (state) {                                                                                                                                                                                                                           
			switch (state) {                                                                                                                                                                                                                                            
				case 1:                                                                                                                                                                                                                                                    
					this.byId("btn_putback").setEnabled(false);                                                                                                                                                                                                               
					this.byId("btn_no_putback").setEnabled(false);                                                                                                                                                                                                            
					this.byId("btn_confirm").setEnabled(false);                                                                                                                                                                                                               
					this.byId("btn_confirm_zero").setEnabled(false);                                                                                                                                                                                                          
					this.byId("inputQtyToRemove").setEnabled(false);                                                                                                                                                                                                          
					this.byId("inputQtyToRemove").setValue(undefined);                                                                                                                                                                                                        
					this.byId("inputUoMToRemove").setEnabled(false);                                                                                                                                                                                                          
					this.byId("inputQtyToRemove").setValue(undefined);                                                                                                                                                                                                        
					break;                                                                                                                                                                                                                                                    
				case 2:                                                                                                                                                                                                                                                    
					this.byId("btn_putback").setEnabled(false);                                                                                                                                                                                                               
					this.byId("btn_no_putback").setEnabled(false);                                                                                                                                                                                                            
					this.byId("btn_confirm").setEnabled(false);                                                                                                                                                                                                               
					this.byId("btn_confirm_zero").setEnabled(true);                                                                                                                                                                                                           
					this.byId("inputQtyToRemove").setEnabled(true);                                                                                                                                                                                                           
					this.byId("inputQtyToRemove").setValue(undefined);                                                                                                                                                                                                        
					this.byId("inputUoMToRemove").setEnabled(true);                                                                                                                                                                                                           
					break;                                                                                                                                                                                                                                                    
				case 2.5:                                                                                                                                                                                                                                                  
					this.byId("btn_putback").setEnabled(false);                                                                                                                                                                                                               
					this.byId("btn_no_putback").setEnabled(false);                                                                                                                                                                                                            
					this.byId("btn_confirm").setEnabled(true);                                                                                                                                                                                                                
					this.byId("btn_confirm_zero").setEnabled(true);                                                                                                                                                                                                           
					this.byId("inputQtyToRemove").setEnabled(true);                                                                                                                                                                                                           
					this.byId("inputUoMToRemove").setEnabled(true);                                                                                                                                                                                                           
					break;                                                                                                                                                                                                                                                    
				case 3:                                                                                                                                                                                                                                                    
					this.byId("btn_putback").setEnabled(true);                                                                                                                                                                                                                
					this.byId("btn_no_putback").setEnabled(false);                                                                                                                                                                                                            
					this.byId("btn_confirm").setEnabled(false);                                                                                                                                                                                                               
					this.byId("btn_confirm_zero").setEnabled(false);                                                                                                                                                                                                          
					this.byId("inputQtyToRemove").setEnabled(false);                                                                                                                                                                                                          
					this.byId("inputUoMToRemove").setEnabled(false);                                                                                                                                                                                                          
					break;                                                                                                                                                                                                                                                    
				case 3.5:                                                                                                                                                                                                                                                  
					this.byId("btn_putback").setEnabled(false);                                                                                                                                                                                                               
					this.byId("btn_no_putback").setEnabled(true);                                                                                                                                                                                                             
					this.byId("btn_confirm").setEnabled(false);                                                                                                                                                                                                               
					this.byId("btn_confirm_zero").setEnabled(false);                                                                                                                                                                                                          
					this.byId("inputQtyToRemove").setEnabled(false);                                                                                                                                                                                                          
					this.byId("inputUoMToRemove").setEnabled(false);                                                                                                                                                                                                          
					break;                                                                                                                                                                                                                                                    
				default:                                                                                                                                                                                                                                                   
					this.byId("btn_putback").setEnabled(false);                                                                                                                                                                                                               
					this.byId("btn_no_putback").setEnabled(false);                                                                                                                                                                                                            
					this.byId("btn_confirm").setEnabled(false);                                                                                                                                                                                                               
					this.byId("btn_confirm_zero").setEnabled(false);                                                                                                                                                                                                          
					this.byId("inputQtyToRemove").setEnabled(false);                                                                                                                                                                                                          
					this.byId("inputQtyToRemove").setValue(undefined);                                                                                                                                                                                                        
					this.byId("inputUoMToRemove").setEnabled(false);                                                                                                                                                                                                          
					break;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		handleUoMToRemoveChange: function (oEvent) {                                                                                                                                                                                                                 
			var oValidatedComboBox = oEvent.getSource(),                                                                                                                                                                                                                
				sSelectedKey = oValidatedComboBox.getSelectedKey(),                                                                                                                                                                                                        
				sValue = oValidatedComboBox.getValue();                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			if (!sSelectedKey && sValue) {                                                                                                                                                                                                                              
				oValidatedComboBox.setValueState(ValueState.Error);                                                                                                                                                                                                        
				oValidatedComboBox.setValueStateText(this.getTranslatedText("ComboBox.UoM.Error"));                                                                                                                                                                        
			} else {                                                                                                                                                                                                                                                    
				oValidatedComboBox.setValueState(ValueState.None);                                                                                                                                                                                                         
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		handleQtyToRemoveChange: function (oEvent) {                                                                                                                                                                                                                 
			const qtyToRemove = oEvent.getParameter("value");                                                                                                                                                                                                           
			if (qtyToRemove) {                                                                                                                                                                                                                                          
				this.setScreenState(2.5);                                                                                                                                                                                                                                  
			} else {                                                                                                                                                                                                                                                    
				this.setScreenState(2);                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onConfirmPressed: function (event, qtySet) {                                                                                                                                                                                                                 
			const qtyToRemove = this.byId("inputQtyToRemove").getValue();                                                                                                                                                                                               
			const uomToRemove = this.byId("inputUoMToRemove").getSelectedKey();                                                                                                                                                                                         
			if (+qtyToRemove > 0 || qtySet === 0) {                                                                                                                                                                                                                     
				const { qtyTaken, qtyInHu } = this.makeUoMCalculations(qtyToRemove, uomToRemove);                                                                                                                                                                          
				if (qtyTaken > qtyInHu) {                                                                                                                                                                                                                                  
					const text = this.getTranslatedText("Confirm.QtyMore.Text");                                                                                                                                                                                              
					const title = this.getTranslatedText("Confirm.QtyMore.Title");                                                                                                                                                                                            
					MessageBox.show(                                                                                                                                                                                                                                          
						text, {                                                                                                                                                                                                                                                  
						icon: MessageBox.Icon.ERROR,                                                                                                                                                                                                                             
						title: title,                                                                                                                                                                                                                                            
						actions: [MessageBox.Action.OK]                                                                                                                                                                                                                          
					});                                                                                                                                                                                                                                                       
				} else if (qtyTaken < qtyInHu) {                                                                                                                                                                                                                           
					this.setScreenState(3);                                                                                                                                                                                                                                   
					this.postQtyRequest(qtyToRemove, uomToRemove);                                                                                                                                                                                                            
				} else {                                                                                                                                                                                                                                                   
					this.setScreenState(3.5);                                                                                                                                                                                                                                 
					this.postQtyRequest(qtyToRemove, uomToRemove);                                                                                                                                                                                                            
				}                                                                                                                                                                                                                                                          
			} else {                                                                                                                                                                                                                                                    
				const zeroText = this.getTranslatedText("Confirm.QtyZero.Text");                                                                                                                                                                                           
				const zeroTitle = this.getTranslatedText("Confirm.QtyZero.Title");                                                                                                                                                                                         
				MessageBox.show(                                                                                                                                                                                                                                           
					zeroText, {                                                                                                                                                                                                                                               
					icon: MessageBox.Icon.ERROR,                                                                                                                                                                                                                              
					title: zeroTitle,                                                                                                                                                                                                                                         
					actions: [MessageBox.Action.OK]                                                                                                                                                                                                                           
				});                                                                                                                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onConfirmZeroQty: function (event) {                                                                                                                                                                                                                         
			const qtyToRemove = this.byId("inputQtyToRemove").getValue();                                                                                                                                                                                               
			const confirmZeroText = this.getTranslatedText("ConfirmZero.NotEmpty.Text");                                                                                                                                                                                
			const confirmZeroTitle = this.getTranslatedText("ConfirmZero.NotEmpty.Title");                                                                                                                                                                              
			if (qtyToRemove) {                                                                                                                                                                                                                                          
				MessageBox.show(                                                                                                                                                                                                                                           
					confirmZeroText, {                                                                                                                                                                                                                                        
					icon: MessageBox.Icon.ERROR,                                                                                                                                                                                                                              
					title: confirmZeroTitle,                                                                                                                                                                                                                                  
					actions: [MessageBox.Action.OK]                                                                                                                                                                                                                           
				});                                                                                                                                                                                                                                                        
			} else {                                                                                                                                                                                                                                                    
				this.openZeroQtyDialog();                                                                                                                                                                                                                                  
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		openZeroQtyDialog: function () {                                                                                                                                                                                                                             
			if (!this.oZeroQtyDialog) {                                                                                                                                                                                                                                 
				const yesText = this.getTranslatedText("ConfirmZeroPopup.Yes");                                                                                                                                                                                            
				const noText = this.getTranslatedText("ConfirmZeroPopup.No");                                                                                                                                                                                              
				const confirmZeroText = this.getTranslatedText("ConfirmZeroPopup.Text");                                                                                                                                                                                   
				const confirmZeroTitle = this.getTranslatedText("ConfirmZeroPopup.Title");                                                                                                                                                                                 
				this.oZeroQtyDialog = new Dialog({                                                                                                                                                                                                                         
					type: DialogType.Message,                                                                                                                                                                                                                                 
					title: confirmZeroTitle,                                                                                                                                                                                                                                  
					content: new Text({ text: confirmZeroText }),                                                                                                                                                                                                             
					beginButton: new Button({                                                                                                                                                                                                                                 
						type: ButtonType.Emphasized,                                                                                                                                                                                                                             
						text: yesText,                                                                                                                                                                                                                                           
						press: function () {                                                                                                                                                                                                                                     
							this.setScreenState(3);                                                                                                                                                                                                                                 
							this.oZeroQtyDialog.close();                                                                                                                                                                                                                            
						}.bind(this)                                                                                                                                                                                                                                             
					}),                                                                                                                                                                                                                                                       
					endButton: new Button({                                                                                                                                                                                                                                   
						text: noText,                                                                                                                                                                                                                                            
						press: function () {                                                                                                                                                                                                                                     
							this.oZeroQtyDialog.close();                                                                                                                                                                                                                            
						}.bind(this)                                                                                                                                                                                                                                             
					})                                                                                                                                                                                                                                                        
				});                                                                                                                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
			this.oZeroQtyDialog.open();                                                                                                                                                                                                                                 
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		makeUoMCalculations: function (qtyToRemove, uomToRemove) {                                                                                                                                                                                                   
			const huData = this.getView().getModel("selectedRow").getData();                                                                                                                                                                                            
			const uomObject = this.getView().getModel("uomsForProduct").getData().find(({ AlternativeUnit }) => AlternativeUnit === uomToRemove);                                                                                                                       
			const huUomObject = this.getView().getModel("uomsForProduct").getData().find(({ AlternativeUnit }) => AlternativeUnit === huData.NavToHUItem.Meins);                                                                                                        
			const qtyTaken = qtyToRemove * uomObject.QuantityNumerator / uomObject.QuantityDenominator;                                                                                                                                                                 
			const qtyInHu = huData.NavToHUItem.Quan * huUomObject.QuantityNumerator / huUomObject.QuantityDenominator;                                                                                                                                                  
			return { qtyTaken, qtyInHu }                                                                                                                                                                                                                                
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		postQtyRequest: function (qty, uom) {                                                                                                                                                                                                                        
			BusyIndicator.show();                                                                                                                                                                                                                                       
			const that = this;                                                                                                                                                                                                                                          
			const loginData = this.getView().getModel("loginData")?.getData();                                                                                                                                                                                          
			const dataModel = new sap.ui.model.odata.v2.ODataModel(constants.service.url);                                                                                                                                                                              
			const requestBody = {                                                                                                                                                                                                                                       
				"Huident": this.getView().getModel("selectedRow").getData().Huident,                                                                                                                                                                                       
				"Lgnum": loginData.Lgnum,                                                                                                                                                                                                                                  
				"Quan": qty,                                                                                                                                                                                                                                               
				"Unit": uom,                                                                                                                                                                                                                                               
				"Workstation": loginData.Workcenter,                                                                                                                                                                                                                       
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			dataModel.create("/PostQuantitySet", requestBody, {                                                                                                                                                                                                         
				success: function (data, loginResponse) {                                                                                                                                                                                                                  
					BusyIndicator.hide();                                                                                                                                                                                                                                     
				},                                                                                                                                                                                                                                                         
				error: function (err) {                                                                                                                                                                                                                                    
					console.log(err);                                                                                                                                                                                                                                         
					that.handleError(err);                                                                                                                                                                                                                                    
					BusyIndicator.hide();                                                                                                                                                                                                                                     
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		setCurrentLoggedInUser: function setCurrentLoggedInUser() {                                                                                                                                                                                                  
			var xmlHttp = new XMLHttpRequest();                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			xmlHttp.onreadystatechange = function () {                                                                                                                                                                                                                  
				if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {                                                                                                                                                                                                    
					var oUserData = JSON.parse(xmlHttp.responseText);                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					var user = " " + oUserData.id;                                                                                                                                                                                                                            
					this.byId("user").setText(this.byId("user").getText().concat(user));                                                                                                                                                                                      
				}                                                                                                                                                                                                                                                          
			}.bind(this);                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			xmlHttp.open("GET", "/sap/bc/ui2/start_up", false);                                                                                                                                                                                                         
			xmlHttp.send(null);                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		setFocusOnScanInput: function setFocusOnScanInput(id) {                                                                                                                                                                                                      
			var input = this.getView().byId(id);                                                                                                                                                                                                                        
			setTimeout(function () {                                                                                                                                                                                                                                    
				input.focus();                                                                                                                                                                                                                                             
			}, 0);                                                                                                                                                                                                                                                      
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		selectFirstTableRow: function selectFirstTableRow(lastSelectedRow) {                                                                                                                                                                                         
			let table = this.byId("huTable");                                                                                                                                                                                                                           
			const firstRow = table.getRows()[0];                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			if (lastSelectedRow !== undefined) {                                                                                                                                                                                                                        
				if (lastSelectedRow < table.getBinding().getModel().getData().results.length) {                                                                                                                                                                            
					this.onHuSelect(undefined, lastSelectedRow);                                                                                                                                                                                                              
					setTimeout(function () {                                                                                                                                                                                                                                  
						return table.setSelectedIndex(lastSelectedRow);                                                                                                                                                                                                          
					}, 0);                                                                                                                                                                                                                                                    
				} else if (firstRow && firstRow.getCells()[0].getText()) {                                                                                                                                                                                                 
					this.onHuSelect(undefined, 0);                                                                                                                                                                                                                            
					setTimeout(function () {                                                                                                                                                                                                                                  
						return firstRow._setSelected(true);                                                                                                                                                                                                                      
					}, 0);                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
			else if (firstRow && firstRow.getCells()[0].getText()) {                                                                                                                                                                                                    
				this.onHuSelect(undefined, 0);                                                                                                                                                                                                                             
				setTimeout(function () {                                                                                                                                                                                                                                   
					return firstRow._setSelected(true);                                                                                                                                                                                                                       
				}, 0);                                                                                                                                                                                                                                                     
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		refreshModels: function refreshModels() {                                                                                                                                                                                                                    
			var models = this.getView().oModels;                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			for (const modelName in models) {                                                                                                                                                                                                                           
				models[modelName].refresh();                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onExitPressed: function () {                                                                                                                                                                                                                                 
			BusyIndicator.show();                                                                                                                                                                                                                                       
			const loginData = this.getView().getModel("loginData")?.getData();                                                                                                                                                                                          
			const lgnum = loginData.Lgnum;                                                                                                                                                                                                                              
			const workcenter = loginData.Workcenter;                                                                                                                                                                                                                    
			const baseUrl = constants.service.login;                                                                                                                                                                                                                    
			let requestBody = {                                                                                                                                                                                                                                         
				"LGNUM": lgnum,                                                                                                                                                                                                                                            
				"WORKSTATION": workcenter,                                                                                                                                                                                                                                 
				"WS_MODE": "",                                                                                                                                                                                                                                             
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			this.createData("LogoffCollection", requestBody, this, baseUrl).then(data => {                                                                                                                                                                              
				console.log(data);                                                                                                                                                                                                                                         
				MessageBox.show(                                                                                                                                                                                                                                           
					"Logged Off", {                                                                                                                                                                                                                                           
					icon: MessageBox.Icon.SUCCESS,                                                                                                                                                                                                                            
					title: "Success",                                                                                                                                                                                                                                         
					actions: [MessageBox.Action.OK]                                                                                                                                                                                                                           
				});                                                                                                                                                                                                                                                        
				this.startProcess();                                                                                                                                                                                                                                       
				BusyIndicator.hide();                                                                                                                                                                                                                                      
			}).catch(err => {                                                                                                                                                                                                                                           
				this.handleError(err);                                                                                                                                                                                                                                     
				console.log(err);                                                                                                                                                                                                                                          
				BusyIndicator.hide();                                                                                                                                                                                                                                      
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
		// Test Fns                                                                                                                                                                                                                                                  
		onHUHeaderPressed: function () {                                                                                                                                                                                                                             
			const lgnum = this.byId("lgnumInput").getValue();                                                                                                                                                                                                           
			const workcenter = this.byId("workcenterInput").getValue();                                                                                                                                                                                                 
			const huNum = this.byId("HUNum").getValue();                                                                                                                                                                                                                
			const baseUrl = constants.service.url;                                                                                                                                                                                                                      
			const filter = [{ "field": "Lgnum", "sign": "EQ", "value": lgnum },                                                                                                                                                                                         
			{ "field": "Workstation", "sign": "EQ", "value": workcenter },                                                                                                                                                                                              
			{ "field": "Huident", "sign": "EQ", "value": huNum }];                                                                                                                                                                                                      
			var dataModel = new sap.ui.model.odata.ODataModel(baseUrl, true);                                                                                                                                                                                           
			dataModel.read(`/HUHeaderSet(Lgnum='${lgnum}',Huident='${huNum}',Workstation='${workcenter}')?$expand=NavToHUItem,NavToHUItemQuantity`, {                                                                                                                   
				success: (data) => {                                                                                                                                                                                                                                       
					console.log(data);                                                                                                                                                                                                                                        
					const title = this.getTranslatedText("Success");                                                                                                                                                                                                          
					MessageBox.show(                                                                                                                                                                                                                                          
						data, {                                                                                                                                                                                                                                                  
						icon: MessageBox.Icon.SUCCESS,                                                                                                                                                                                                                           
						title: title,                                                                                                                                                                                                                                            
						actions: [MessageBox.Action.OK]                                                                                                                                                                                                                          
					});                                                                                                                                                                                                                                                       
				},                                                                                                                                                                                                                                                         
				error: (err) => {                                                                                                                                                                                                                                          
					this.handleError(err);                                                                                                                                                                                                                                    
					console.log(err)                                                                                                                                                                                                                                          
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onGetLgnumPressed: function () {                                                                                                                                                                                                                             
			const baseUrl = constants.service.url;                                                                                                                                                                                                                      
			var dataModel = new sap.ui.model.odata.ODataModel(baseUrl, true);                                                                                                                                                                                           
			dataModel.callFunction(                                                                                                                                                                                                                                     
				"/GetUserDefaultWarehouse", {                                                                                                                                                                                                                              
				method: "GET",                                                                                                                                                                                                                                             
				urlParameters: {},                                                                                                                                                                                                                                         
				success: function (data) {                                                                                                                                                                                                                                 
					console.log(data);                                                                                                                                                                                                                                        
					MessageBox.show(                                                                                                                                                                                                                                          
						data, {                                                                                                                                                                                                                                                  
						icon: MessageBox.Icon.SUCCESS,                                                                                                                                                                                                                           
						title: "Success",                                                                                                                                                                                                                                        
						actions: [MessageBox.Action.OK]                                                                                                                                                                                                                          
					});                                                                                                                                                                                                                                                       
				}.bind(this),                                                                                                                                                                                                                                              
				error: function (err) {                                                                                                                                                                                                                                    
					this.handleError(err);                                                                                                                                                                                                                                    
					console.log(err)                                                                                                                                                                                                                                          
				}.bind(this)                                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
			);                                                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onTestLoginPressed: function () {                                                                                                                                                                                                                            
			const lgnum = this.byId("lgnumInput").getValue();                                                                                                                                                                                                           
			const workcenter = this.byId("workcenterInput").getValue();                                                                                                                                                                                                 
			const baseUrl = constants.service.login;                                                                                                                                                                                                                    
			var dataModel = new sap.ui.model.odata.ODataModel(baseUrl, true);                                                                                                                                                                                           
			// const filter = [{ "field": "Lgnum", "sign": "EQ", "value": lgnum },                                                                                                                                                                                      
			// { "field": "Workstation", "sign": "EQ", "value": workcenter }];                                                                                                                                                                                          
			dataModel.read(`/LogonCollection(WORKSTATION='${workcenter}',WS_MODE='SMPL')`, {                                                                                                                                                                            
				success: (data) => {                                                                                                                                                                                                                                       
					console.log(data);                                                                                                                                                                                                                                        
					MessageBox.show(                                                                                                                                                                                                                                          
						data, {                                                                                                                                                                                                                                                  
						icon: MessageBox.Icon.SUCCESS,                                                                                                                                                                                                                           
						title: "Success",                                                                                                                                                                                                                                        
						actions: [MessageBox.Action.OK]                                                                                                                                                                                                                          
					});                                                                                                                                                                                                                                                       
				},                                                                                                                                                                                                                                                         
				error: (err) => {                                                                                                                                                                                                                                          
					this.handleError(err);                                                                                                                                                                                                                                    
					console.log(err)                                                                                                                                                                                                                                          
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onTestLogoffPressed: function () {                                                                                                                                                                                                                           
			const lgnum = this.byId("lgnumInput").getValue();                                                                                                                                                                                                           
			const workcenter = this.byId("workcenterInput").getValue();                                                                                                                                                                                                 
			const baseUrl = constants.service.login;                                                                                                                                                                                                                    
			let requestBody = {                                                                                                                                                                                                                                         
				"LGNUM": lgnum,                                                                                                                                                                                                                                            
				"WORKSTATION": workcenter,                                                                                                                                                                                                                                 
				"WS_MODE": "",                                                                                                                                                                                                                                             
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			this.createData("LogoffCollection", requestBody, this, baseUrl).then(data => {                                                                                                                                                                              
				console.log(data);                                                                                                                                                                                                                                         
				MessageBox.show(                                                                                                                                                                                                                                           
					data, {                                                                                                                                                                                                                                                   
					icon: MessageBox.Icon.SUCCESS,                                                                                                                                                                                                                            
					title: "Success",                                                                                                                                                                                                                                         
					actions: [MessageBox.Action.OK]                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
				})                                                                                                                                                                                                                                                         
			}).catch(err => {                                                                                                                                                                                                                                           
				this.handleError(err);                                                                                                                                                                                                                                     
				console.log(err);                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onGetWCsPressed: function () {                                                                                                                                                                                                                               
			const lgnum = this.byId("lgnumInput").getValue();                                                                                                                                                                                                           
			const filter = [{ "field": "Lgnum", "sign": "EQ", "value": lgnum }];                                                                                                                                                                                        
			this.requestData("VH_WorkstationSet", filter, this).then(data => {                                                                                                                                                                                          
				console.log(data);                                                                                                                                                                                                                                         
				MessageBox.show(                                                                                                                                                                                                                                           
					data, {                                                                                                                                                                                                                                                   
					icon: MessageBox.Icon.SUCCESS,                                                                                                                                                                                                                            
					title: "Success",                                                                                                                                                                                                                                         
					actions: [MessageBox.Action.OK]                                                                                                                                                                                                                           
				});                                                                                                                                                                                                                                                        
			}).catch(err => {                                                                                                                                                                                                                                           
				this.handleError(err);                                                                                                                                                                                                                                     
				console.log(err);                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onGetLgnumsPressed: function () {                                                                                                                                                                                                                            
			const filter = []                                                                                                                                                                                                                                           
			this.requestData("VH_WarehouseNumberSet", filter, this).then(data => {                                                                                                                                                                                      
				console.log(data);                                                                                                                                                                                                                                         
				MessageBox.show(                                                                                                                                                                                                                                           
					data, {                                                                                                                                                                                                                                                   
					icon: MessageBox.Icon.SUCCESS,                                                                                                                                                                                                                            
					title: "Success",                                                                                                                                                                                                                                         
					actions: [MessageBox.Action.OK]                                                                                                                                                                                                                           
				});                                                                                                                                                                                                                                                        
			}).catch(err => {                                                                                                                                                                                                                                           
				this.handleError(err);                                                                                                                                                                                                                                     
				console.log(err);                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onGetUoMsPressed: function () {                                                                                                                                                                                                                              
			const lgnum = this.byId("lgnumInput").getValue();                                                                                                                                                                                                           
			const msehl = this.byId("msehlInput").getValue();                                                                                                                                                                                                           
			const msehi = this.byId("msehiInput").getValue();                                                                                                                                                                                                           
			const wc = this.byId("workcenterInput").getValue();                                                                                                                                                                                                         
			const huiden = this.byId("HUNum").getValue();                                                                                                                                                                                                               
			const filter = [{ "field": "Product", "sign": "EQ", "value": msehl }];                                                                                                                                                                                      
			this.requestData("ProductUnitOfMeasureSet", filter, this).then(data => {                                                                                                                                                                                    
				console.log(data);                                                                                                                                                                                                                                         
				MessageBox.show(                                                                                                                                                                                                                                           
					data, {                                                                                                                                                                                                                                                   
					icon: MessageBox.Icon.SUCCESS,                                                                                                                                                                                                                            
					title: "Success",                                                                                                                                                                                                                                         
					actions: [MessageBox.Action.OK]                                                                                                                                                                                                                           
				});                                                                                                                                                                                                                                                        
			}).catch(err => {                                                                                                                                                                                                                                           
				this.handleError(err);                                                                                                                                                                                                                                     
				console.log(err);                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onPostRequest: function () {                                                                                                                                                                                                                                 
			const lgnum = this.byId("lgnumInput").getValue();                                                                                                                                                                                                           
			const msehl = this.byId("msehlInput").getValue();                                                                                                                                                                                                           
			const msehi = this.byId("msehiInput").getValue();                                                                                                                                                                                                           
			const wc = this.byId("workcenterInput").getValue();                                                                                                                                                                                                         
			const huiden = this.byId("HUNum").getValue();                                                                                                                                                                                                               
			const qty = this.byId("qtyInput").getValue();                                                                                                                                                                                                               
			const dataModel = new sap.ui.model.odata.v2.ODataModel(constants.service.url);                                                                                                                                                                              
			const requestBody = {                                                                                                                                                                                                                                       
				"Huident": huiden,                                                                                                                                                                                                                                         
				"Lgnum": lgnum,                                                                                                                                                                                                                                            
				"Quan": qty,                                                                                                                                                                                                                                               
				"Unit": msehi,                                                                                                                                                                                                                                             
				"Workstation": wc,                                                                                                                                                                                                                                         
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			dataModel.create("/PostQuantitySet", requestBody, {                                                                                                                                                                                                         
				success: function (data, oResponse) {                                                                                                                                                                                                                      
					console.log(data);                                                                                                                                                                                                                                        
					MessageBox.show(                                                                                                                                                                                                                                          
						data, {                                                                                                                                                                                                                                                  
						icon: MessageBox.Icon.SUCCESS,                                                                                                                                                                                                                           
						title: "Success",                                                                                                                                                                                                                                        
						actions: [MessageBox.Action.OK]                                                                                                                                                                                                                          
					});                                                                                                                                                                                                                                                       
				},                                                                                                                                                                                                                                                         
				error: function (err) {                                                                                                                                                                                                                                    
					console.log(err);                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onCloseTesting: function (oEvent) {                                                                                                                                                                                                                          
			if (this.testDialog) {                                                                                                                                                                                                                                      
				this.byId("testDialog").close();                                                                                                                                                                                                                           
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onOpenTesLoginDialog: function () {                                                                                                                                                                                                                          
			const loginView = new JSONModel({                                                                                                                                                                                                                           
				User: "sbabalev",                                                                                                                                                                                                                                          
				Workcenter: "",                                                                                                                                                                                                                                            
				Lgnum: ""                                                                                                                                                                                                                                                  
			})                                                                                                                                                                                                                                                          
			if (!this.oLoginDialog) {                                                                                                                                                                                                                                   
				const that = this;                                                                                                                                                                                                                                         
				this.oLoginDialog = Fragment.load({                                                                                                                                                                                                                        
					id: that.getView().getId(),                                                                                                                                                                                                                               
					name: "z_vi02_sampling.view.LoginPopup",                                                                                                                                                                                                                  
					controller: that                                                                                                                                                                                                                                          
				}).then(function (oDialog) {                                                                                                                                                                                                                               
					that.getView().addDependent(oDialog);                                                                                                                                                                                                                     
					oDialog.setModel(loginView, "loginModel");                                                                                                                                                                                                                
					return oDialog;                                                                                                                                                                                                                                           
				});                                                                                                                                                                                                                                                        
			} else {                                                                                                                                                                                                                                                    
				this.byId("loginDialog").setModel(loginView, "loginModel");                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
			this.oLoginDialog.then(function (oDialog) {                                                                                                                                                                                                                 
				oDialog.open();                                                                                                                                                                                                                                            
			});                                                                                                                                                                                                                                                         
		}                                                                                                                                                                                                                                                            
		// Test Fns                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
	});                                                                                                                                                                                                                                                           
});                                                                                                                                                                                                                                                            